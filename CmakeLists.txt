cmake_minimum_required(VERSION 3.18)
project(opengl_engine LANGUAGES CXX)

# CMAKE Standards
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_BUILD_TYPE Debug)

# Locate needed libraries
find_package(OpenGL REQUIRED)
find_package(glfw3 REQUIRED)
find_package(GLEW REQUIRED)

# Define imported DLL
add_library(libassimp SHARED IMPORTED)

# Specify location of DLL, import library and headers
set_target_properties(libassimp PROPERTIES
    IMPORTED_LOCATION "${CMAKE_CURRENT_SOURCE_DIR}/lib/libassimp-6.dll"
    IMPORTED_IMPLIB "${CMAKE_CURRENT_SOURCE_DIR}/lib/libassimp-6.dll"
    INTERFACE_INCLUDE_DIRECTORIES "${CMAKE_CURRENT_SOURCE_DIR}/include"
)

include_directories("${CMAKE_CURRENT_SOURCE_DIR}/assimp")

add_executable(${CMAKE_PROJECT_NAME} 
    src/main.cpp 
    src/engine/engine.cpp 
    src/shader/shader.cpp 
    src/timer/timer.cpp 
    src/image_loader/image_loader.cpp 
    src/camera/camera.cpp
    src/mesh/mesh.cpp
    src/model/model.cpp

    imgui/imgui.cpp
    imgui/imgui_demo.cpp
    imgui/imgui_draw.cpp
    imgui/imgui_tables.cpp
    imgui/imgui_tables.cpp
    imgui/imgui_widgets.cpp
    imgui/backends/imgui_impl_glfw.cpp
    imgui/backends/imgui_impl_opengl3.cpp
)

if(${CMAKE_BUILD_TYPE} STREQUAL Debug)
    target_compile_definitions(${CMAKE_PROJECT_NAME} PUBLIC RESOURCES="${CMAKE_CURRENT_SOURCE_DIR}/resources")
else()
    target_compile_definitions(${CMAKE_PROJECT_NAME} PUBLIC RESOURCES="./resources")
endif()


# Linking all required libraries
target_link_libraries(${CMAKE_PROJECT_NAME} PRIVATE OpenGL::GL GLEW::GLEW glfw libassimp)

# Include libgcc and libstdc++ for retrieving dll libraries
if(${CMAKE_BUILD_TYPE} STREQUAL Release)
    target_link_options(${CMAKE_PROJECT_NAME} PRIVATE -static-libgcc -static-libstdc++)
endif()